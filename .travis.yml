language: cpp
sudo: false

os:
  - linux

compiler:
  - clang
  - gcc

addons:
  apt: &gcc5
     packages:
       - g++-5
       - gcc-5
     sources:
       - ubuntu-toolchain-r-test


install:
  - if [ ! "$(ls -A cmake-3.4.0-Linux-x86_64)" ]; then
      wget --no-check-certificate https://cmake.org/files/v3.4/cmake-3.4.0-Linux-x86_64.tar.gz
      && tar xf cmake-3.4.0-Linux-x86_64.tar.gz
      && rm cmake-3.4.0-Linux-x86_64.tar.gz;
    fi

before_script:
  - if [ "$CXX" == "clang++" ]; then export CXXCOMPILER="clang"; fi
  - if [ "$CXX" == "g++" ];     then export CXXCOMPILER="gcc"; fi
  - git submodule update --init --recursive
  - mkdir build
  - cd build
  - ../cmake-3.4.0-Linux-x86_64/bin/cmake ..

script:
  - make

cache:
  directories:
    - cmake-3.4.0-Linux-x86_64